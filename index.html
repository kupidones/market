<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Main App - Fullscreen</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 100%;
        text-align: center;
        padding-top: 20px;
      }

      .mode-indicator {
        background: rgba(255, 255, 255, 0.2);
        padding: 10px;
        border-radius: 10px;
        margin-bottom: 20px;
        backdrop-filter: blur(10px);
      }

      h1 {
        font-size: 28px;
        margin-bottom: 20px;
        font-weight: 600;
      }

      .button {
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        color: white;
        padding: 15px 25px;
        border-radius: 25px;
        font-size: 16px;
        cursor: pointer;
        margin: 8px;
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
        width: 90%;
        max-width: 300px;
      }

      .button:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
      }

      .button-group {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        margin: 20px 0;
      }

      .info-panel {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: 15px;
        margin: 20px 0;
        backdrop-filter: blur(10px);
        text-align: left;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="mode-indicator">
        <strong>üöÄ –†–µ–∂–∏–º: FULLSCREEN</strong>
      </div>

      <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
      <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ</p>

      <div class="button-group">
        <button class="button" onclick="sendData()">üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        <button class="button" onclick="toggleFullscreen()">
          üîÑ –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º
        </button>
        <button class="button" onclick="showUserInfo()">
          üë§ –ò–Ω—Ñ–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        </button>
        <button class="button" onclick="closeApp()">
          ‚ùå –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        </button>
      </div>

      <div class="info-panel">
        <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∂–∏–º–µ:</h3>
        <p id="modeInfo">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        <p id="viewportInfo">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
      </div>
    </div>

    <script>
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
      const tg = window.Telegram.WebApp;

      // –Ø–≤–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
      function initializeFullscreen() {
        // –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        tg.expand(); // –≠—Ç–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        tg.enableClosingConfirmation();
        tg.setHeaderColor("#667eea");
        tg.setBackgroundColor("#667eea");

        console.log("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ");
        updateModeInfo();
      }

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞
      function toggleFullscreen() {
        if (tg.isExpanded) {
          tg.close(); // –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        } else {
          tg.expand(); // –û—Ç–∫—Ä—ã—Ç—å –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ
        }
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–∂–∏–º–µ
      function updateModeInfo() {
        const modeInfo = document.getElementById("modeInfo");
        const viewportInfo = document.getElementById("viewportInfo");

        modeInfo.textContent = `–†–µ–∂–∏–º: ${
          tg.isExpanded ? "FULLSCREEN" : "COMPACT"
        }`;
        viewportInfo.textContent = `–í—ã—Å–æ—Ç–∞ viewport: ${tg.viewportHeight}px, –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞: ${tg.viewportStableHeight}px`;
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
      function showUserInfo() {
        const user = tg.initDataUnsafe?.user;
        if (user) {
          tg.showPopup({
            title: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ",
            message: `ID: ${user.id}\n–ò–º—è: ${user.first_name}\n–§–∞–º–∏–ª–∏—è: ${
              user.last_name || "–ù–µ —É–∫–∞–∑–∞–Ω–∞"
            }\nUsername: ${user.username || "–ù–µ —É–∫–∞–∑–∞–Ω"}`,
            buttons: [{ type: "ok" }],
          });
        } else {
          tg.showPopup({
            title: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",
            message: "–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã",
            buttons: [{ type: "ok" }],
          });
        }
      }

      // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–∞
      function sendData() {
        const data = {
          action: "fullscreen_button_click",
          timestamp: new Date().toISOString(),
          mode: tg.isExpanded ? "fullscreen" : "compact",
          viewport_height: tg.viewportHeight,
        };

        tg.sendData(JSON.stringify(data));

        tg.showPopup({
          title: "–£—Å–ø–µ—à–Ω–æ!",
          message: "–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –±–æ—Ç–∞",
          buttons: [{ type: "ok" }],
        });
      }

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
      function closeApp() {
        tg.close();
      }

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
      tg.onEvent("viewportChanged", updateModeInfo);
      tg.onEvent("themeChanged", updateModeInfo);

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      tg.ready();
      initializeFullscreen();

      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
      setInterval(updateModeInfo, 1000);
    </script>
  </body>
</html>
