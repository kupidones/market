<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MiniMarket</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: #f8f9fa;
        color: #333;
      }
      .container {
        max-width: 100%;
        padding: 15px;
      }
      .header {
        text-align: center;
        padding: 20px 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 0 0 20px 20px;
        margin-bottom: 20px;
      }
      .product-card {
        background: white;
        border-radius: 12px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        border: 1px solid #e9ecef;
      }
      .product-image {
        width: 100%;
        height: 150px;
        background: #e9ecef;
        border-radius: 8px;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        color: #6c757d;
      }
      .product-title {
        font-weight: 600;
        margin-bottom: 5px;
        font-size: 16px;
      }
      .product-price {
        color: #28a745;
        font-weight: bold;
        font-size: 18px;
        margin-bottom: 10px;
      }
      .btn {
        background: #007bff;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 8px;
        width: 100%;
        font-size: 16px;
        cursor: pointer;
        transition: background 0.3s;
      }
      .btn:hover {
        background: #0056b3;
      }
      .btn:active {
        transform: scale(0.98);
      }
      .cart-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        font-size: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        cursor: pointer;
      }
      .cart-count {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #dc3545;
        color: white;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üõçÔ∏è MiniMarket</h1>
        <p>–ü–æ–∫—É–ø–∞–π—Ç–µ –ª–µ–≥–∫–æ –∏ –±—ã—Å—Ç—Ä–æ!</p>
      </div>

      <div id="products-list">
        <!-- –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–¥–µ—Å—å -->
      </div>
    </div>

    <button class="cart-btn" onclick="openCart()">
      üõí
      <span class="cart-count" id="cart-count">0</span>
    </button>

    <script>
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
      const tg = window.Telegram.WebApp;
      tg.ready();
      tg.expand();

      // –î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤
      const products = [
        {
          id: 1,
          name: "–°–º–∞—Ä—Ç—Ñ–æ–Ω Xiaomi",
          price: 19990,
          image: "üì±",
          description: "–ù–æ–≤—ã–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω —Å –æ—Ç–ª–∏—á–Ω–æ–π –∫–∞–º–µ—Ä–æ–π",
        },
        {
          id: 2,
          name: "–ù–∞—É—à–Ω–∏–∫–∏ Wireless",
          price: 4990,
          image: "üéß",
          description: "–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ —Å —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º",
        },
        {
          id: 3,
          name: "–ß–∞—Å—ã Smart Watch",
          price: 8990,
          image: "‚åö",
          description: "–£–º–Ω—ã–µ —á–∞—Å—ã —Å —Ñ—É–Ω–∫—Ü–∏–µ–π —Ñ–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä–∞",
        },
        {
          id: 4,
          name: "–ù–æ—É—Ç–±—É–∫ HP",
          price: 45990,
          image: "üíª",
          description: "–ú–æ—â–Ω—ã–π –Ω–æ—É—Ç–±—É–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã –∏ –∏–≥—Ä",
        },
        {
          id: 5,
          name: "–ö–æ—Ñ–µ–≤–∞—Ä–∫–∞",
          price: 12990,
          image: "‚òï",
          description: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ñ–µ–≤–∞—Ä–∫–∞ –¥–ª—è –¥–æ–º–∞",
        },
        {
          id: 6,
          name: "–§–∏—Ç–Ω–µ—Å-–±—Ä–∞—Å–ª–µ—Ç",
          price: 2990,
          image: "üèÉ",
          description: "–¢—Ä–µ–∫–µ—Ä –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å–Ω–∞",
        },
      ];

      // –ö–æ—Ä–∑–∏–Ω–∞
      let cart = [];

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
      function initApp() {
        displayProducts();
        updateCartCount();
      }

      // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
      function displayProducts() {
        const productsList = document.getElementById("products-list");

        productsList.innerHTML = products
          .map(
            (product) => `
                <div class="product-card">
                    <div class="product-image">
                        <span style="font-size: 48px;">${product.image}</span>
                    </div>
                    <div class="product-title">${product.name}</div>
                    <div class="product-price">${product.price.toLocaleString()} ‚ÇΩ</div>
                    <p style="color: #666; font-size: 14px; margin-bottom: 15px;">${
                      product.description
                    }</p>
                    <button class="btn" onclick="addToCart(${product.id})">
                        –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </div>
            `
          )
          .join("");
      }

      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
      function addToCart(productId) {
        const product = products.find((p) => p.id === productId);
        cart.push(product);
        updateCartCount();

        tg.showPopup({
          title: "‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ!",
          message: `${product.name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É`,
        });
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
      function updateCartCount() {
        document.getElementById("cart-count").textContent = cart.length;
      }

      // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
      function openCart() {
        if (cart.length === 0) {
          tg.showAlert("üõí –ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞\n–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞");
          return;
        }

        const total = cart.reduce((sum, item) => sum + item.price, 0);
        const itemsList = cart
          .map((item) => `‚Ä¢ ${item.name} - ${item.price.toLocaleString()} ‚ÇΩ`)
          .join("\n");

        tg.showConfirm(
          `üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞:\n\n${itemsList}\n\nüí∞ –ò—Ç–æ–≥–æ: ${total.toLocaleString()} ‚ÇΩ\n\n–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑?`,
          (isConfirmed) => {
            if (isConfirmed) {
              processOrder();
            }
          }
        );
      }

      // –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
      function processOrder() {
        const total = cart.reduce((sum, item) => sum + item.price, 0);

        tg.showPopup({
          title: "üéâ –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!",
          message: `–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!\n–°—É–º–º–∞: ${total.toLocaleString()} ‚ÇΩ\n–° –≤–∞–º–∏ —Å–≤—è–∂—É—Ç—Å—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.`,
        });

        // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
        cart = [];
        updateCartCount();
      }

      // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
      initApp();
    </script>
  </body>
</html>
